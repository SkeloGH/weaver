"use strict";const fs=require("fs"),CLI_CONFIG=require("../.config"),{getJSONContent,validateConfig,isValidConfigObject}=require("../options/config"),{absPathname}=require("../options/shared");let CLI_ARGS={};const readConfigFile=()=>{let a={};const b=CLI_CONFIG.filePath,c=validateConfig(b).valid;return c&&(a=getJSONContent(b)),{config:a.config||{filePath:null},queries:a.queries||null,dataClients:a.dataClients||null,jsonConfig:a.jsonConfig||null}},parseCLIConfig=()=>{const{queries:a}=CLI_ARGS,b=CLI_ARGS["json-file"]?{filePath:CLI_ARGS["json-file"]}:null;// not implemented
return{queries:a,dataClients:null,jsonConfig:b}},readCLISettings=()=>{const a=parseCLIConfig(),b=a.queries||CLI_CONFIG.queries,c=a.dataClients||CLI_CONFIG.dataClients,d=a.jsonConfig||CLI_CONFIG.jsonConfig;return{queries:b||null,dataClients:c||null,jsonConfig:d||null}},getQueries=(a,b)=>{let c=null;return a.queries&&0<a.queries.length&&(c=a.queries),!c&&b.queries&&b.queries.length&&(c=b.queries),c=c||[],c},getConfig=(a={})=>{CLI_ARGS=a;const b=readConfigFile(),c=readCLISettings(),{config:d}=b,e=getQueries(b,c),f=b.dataClients||c.dataClients||[],g=b.jsonConfig||c.jsonConfig||{};return{config:d,queries:e,dataClients:f,jsonConfig:g}},setConfig=(a={})=>{const b=isValidConfigObject(a),c=absPathname(__dirname,"./../.config.json");if(b)try{return fs.writeFileSync(c,JSON.stringify(a,null,2)),!0}catch(a){return console.log(a),!1}return!1};module.exports={readConfigFile,parseCLIConfig,readCLISettings,getConfig,setConfig};