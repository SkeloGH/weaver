"use strict";const Debug=require("debug"),shell=require("shelljs"),{getConfig}=require("../lib/config"),Weaver=require("../../src"),logging=Debug("Weaver:bin:commands:run");module.exports={name:"run",description:"Runs the app with the loaded configuration",setup:a=>a,parse:a=>{logging(`getting config from argv ${a}`);const b=getConfig(a),c=JSON.stringify(b,null,2);let d=`Running with the current configuration"\n ${c}`;const e=b.queries&&0<b.queries.length,f=b.dataClients&&0<b.dataClients.length;if(f||(d=`Error: dataClients not set, try adding them:
      - To the configuration file, or
      - Using the configuration wizard
      `),shell.echo(d),!(f&&e))return a;const g=new Weaver(b);return g.run(a=>{logging("Result",a),logging("Done"),g.disconnect(process.exit)}),a}};